
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symptom Tracker</title>
</head>
<body>
    <h1>Symptom Tracker</h1>
    <form id="symptom-form">

        <label for="date">Date:</label>
        <input type="date" id="date" name="date" value="2025-04-18"><br><br>

        <label for="primary-symptom">Primary Symptom Type:</label>
        <select id="primary-symptom" name="primary-symptom">
            <option value="PET">PET (Patulous Eustachian Tube)</option>
            <option value="ETD">ETD (Eustachian Tube Dysfunction)</option>
            <option value="Both">Both</option>
        </select><br><br>

        <fieldset>
            <legend>Symptoms:</legend>
            <label><input type="checkbox" name="symptoms" value="Autophony"> Autophony</label><br>
            <label><input type="checkbox" name="symptoms" value="Blocked ear feeling"> Blocked ear feeling</label><br>
            <label><input type="checkbox" name="symptoms" value="Crackling"> Crackling</label><br>
            <label><input type="checkbox" name="symptoms" value="Popping"> Popping</label><br>
            <label><input type="checkbox" name="symptoms" value="Squeaking"> Squeaking</label><br>
            <label><input type="checkbox" name="symptoms" value="Ear fullness"> Ear fullness</label><br>
            <label><input type="checkbox" name="symptoms" value="Tinnitus"> Tinnitus</label><br>
            <label><input type="checkbox" name="symptoms" value="Improvement lying down"> Improvement when lying down</label><br>
            <label><input type="checkbox" name="symptoms" value="Worse lying down"> Worse when lying down</label><br>
            <label><input type="checkbox" name="symptoms" value="Sound sensitivity"> Sound sensitivity</label><br>
            <label><input type="checkbox" name="symptoms" value="Ear pain"> Ear pain</label><br>
            <label><input type="checkbox" name="symptoms" value="Jaw pain"> Jaw pain</label><br>
            <label><input type="checkbox" name="symptoms" value="Dizziness"> Dizziness</label><br>
            <label><input type="checkbox" name="symptoms" value="Clicking"> Clicking</label><br>
            <label><input type="checkbox" name="symptoms" value="Improvement with cold"> Improvement during mild cold</label><br>
            <label for="other-symptom">Other:</label>
            <input type="text" id="other-symptom" name="other-symptom"><br>
        </fieldset><br>

        <label for="caffeine">Caffeine Intake:</label>
        <input type="text" id="caffeine" name="caffeine" placeholder="e.g. 1x coffee, 1x coke">
        <p>Estimated Caffeine: <span id="caffeine-mg">0</span> mg</p><br>

        <label for="water">Water Intake (ml):</label>
        <input type="number" id="water" name="water"><br><br>

        <label for="sleep-quality">Sleep Quality (1–10):</label>
        <input type="number" id="sleep-quality" name="sleep-quality" min="1" max="10"><br><br>

        <label for="sleep-hours">Sleep Hours (optional):</label>
        <input type="number" id="sleep-hours" name="sleep-hours" step="0.5"><br><br>

        <label for="treatments">Treatments Tried:</label>
        <input type="text" id="treatments" name="treatments"><br><br>

        <label for="relief">Relief from treatment?</label>
        <select id="relief" name="relief">
            <option value="">-- Select --</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
        </select><br><br>

        <label for="notes">General Notes:</label><br>
        <textarea id="notes" name="notes" rows="4" cols="50"></textarea><br><br>

        <button type="submit">Save Entry</button>
    </form>

    <h2>Saved Logs</h2>
    <ul id="log-list"></ul>

    <script>
        const form = document.getElementById('symptom-form');
        const logList = document.getElementById('log-list');
        const caffeineInput = document.getElementById('caffeine');
        const caffeineMg = document.getElementById('caffeine-mg');

        function estimateCaffeine(text) {
            const lower = text.toLowerCase();
            let total = 0;
            if (lower.includes("coffee")) total += 95;
            if (lower.includes("coke")) total += 34;
            if (lower.includes("tea")) total += 26;
            if (lower.includes("energy")) total += 80;
            return total;
        }

        function loadLogs() {
            const logs = JSON.parse(localStorage.getItem('logs')) || [];
            logList.innerHTML = '';
            logs.forEach(log => {
                const li = document.createElement('li');
                li.textContent = `${log.date} — ${log.symptoms.join(', ')}`;
                logList.appendChild(li);
            });
        }

        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const log = {
                date: formData.get("date"),
                primarySymptom: formData.get("primary-symptom"),
                symptoms: formData.getAll("symptoms").concat(formData.get("other-symptom") || "").filter(Boolean),
                caffeine: formData.get("caffeine"),
                caffeineMg: estimateCaffeine(formData.get("caffeine")),
                water: formData.get("water"),
                sleepQuality: formData.get("sleep-quality"),
                sleepHours: formData.get("sleep-hours"),
                treatments: formData.get("treatments"),
                relief: formData.get("relief"),
                notes: formData.get("notes")
            };

            const logs = JSON.parse(localStorage.getItem('logs')) || [];
            logs.push(log);
            localStorage.setItem('logs', JSON.stringify(logs));
            loadLogs();
            form.reset();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            caffeineMg.textContent = 0;
        });

        caffeineInput.addEventListener('input', () => {
            const text = caffeineInput.value;
            caffeineMg.textContent = estimateCaffeine(text);
        });

        document.addEventListener('DOMContentLoaded', () => {
            loadLogs();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
        });
    </script>
</body>
</html>
